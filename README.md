# نظام التعليم الإلكتروني بمعمارية الخدمات المصغرة (E-Learning Platform - Microservices Architecture)

![Java](https://img.shields.io/badge/Java-17-blue)
![Spring Boot](https://img.shields.io/badge/Spring%20Boot-3.x-green)
![Maven](https://img.shields.io/badge/Maven-3.8-red)
![License](https://img.shields.io/badge/License-MIT-yellow)

---

## 1. نظرة عامة على المشروع

هذا المشروع هو تطبيق لمقرر **البرمجة الموزعة**، ويهدف إلى تصميم وتنفيذ نظام تعليم إلكتروني متكامل باستخدام **معمارية الخدمات المصغيرة (Microservices)**. تم تفكيك النظام إلى مجموعة من الخدمات المستقلة التي تتفاعل مع بعضها البعض لتوفير منصة قوية ومرنة وقابلة للتوسع.

الهدف الأساسي هو إظهار الفهم العملي للمفاهيم المتقدمة في الأنظمة الموزعة، بما في ذلك:
- اكتشاف الخدمات (Service Discovery)
- بوابة الدخول الموحدة (API Gateway)
- التواصل الداخلي بين الخدمات (Inter-service Communication)
- الحماية من الفشل (Fault Tolerance)
- توزيع الحمل (Load Balancing)

---

## 2. المعمارية المتبعة (System Architecture)

يعتمد النظام على معمارية موزعة تتكون من عدة خدمات أساسية وبنية تحتية داعمة. يوضح المخطط التالي تدفق الطلبات والتفاعل بين المكونات:

+-----------+ +-----------------+ +-----------------+
| Client | ----> | API Gateway | <---->| Eureka Server |
| (Postman/ | | (Port: 8080) | | (Discovery) |
| Browser) | +-------+---------+ | (Port: 8761) |
+-----------+ | +-----------------+
|
+----------------+----------------+
| |
v v
+------------------+ +--------------------+ +------------------+
| User Service | | Course Service |------>| (Feign Client) |
| (Port: 8081) | <------ | (Port: 8082+) | +------------------+
+------------------+ +--------------------+
| H2 Database | | H2 Database |
+------------------+ +--------------------+

**شرح تدفق الطلب:**
1.  **العميل** يرسل جميع طلبات HTTP إلى **API Gateway**، التي تعمل كنقطة دخول موحدة للنظام.
2.  **API Gateway** تستقبل الطلب وتستشير **Eureka Server** لمعرفة العنوان الديناميكي للخدمة المطلوبة (مثل `user-service`).
3.  تقوم البوابة بتوجيه الطلب إلى النسخة المتاحة من الخدمة المناسبة.
4.  إذا احتاجت خدمة ما (مثل `course-service`) إلى بيانات من خدمة أخرى (مثل `user-service`)، فإنها تستخدم **Feign Client** الذي بدوره يستشير Eureka للعثور على الخدمة المستهدفة واستدعائها.
5.  تعود الاستجابة عبر نفس المسار إلى العميل.

---

## 3. الميزات الرئيسية (Features)

-   **إدارة المستخدمين (User Management)**:
    -   إنشاء مستخدمين جدد بأدوار مختلفة (طالب، مدرب، مسؤول).
    -   عرض جميع المستخدمين.
-   **إدارة الدورات (Course Management)**:
    -   إنشاء دورة جديدة من قبل مدرب مسجل.
    -   التحقق من وجود المدرب وصلاحيته قبل إنشاء الدورة (عبر التواصل الداخلي).
    -   عرض الدورات المتاحة.
    -   آلية للموافقة على الدورات (من قبل المسؤول).
-   **بنية تحتية قوية (Robust Infrastructure)**:
    -   **عنونة ديناميكية**: لا توجد عناوين IP أو منافذ ثابتة في الكود.
    -   **حماية من الفشل**: النظام قادر على التعامل مع حالات عدم توفر إحدى الخدمات دون أن ينهار بالكامل.
    -   **قابلية التوسع**: يمكن تشغيل نسخ متعددة من أي خدمة لتوزيع الحمل عليها.

---

## 4. التقنيات المستخدمة (Technology Stack)

-   **☕ Java 21**: اللغة الأساسية للمشروع.
-   **🌱 Spring Boot 3.5**: إطار العمل الرئيسي لتسهيل بناء الخدمات.
-   **☁️ Spring Cloud**: حزمة متكاملة لتطبيقات الأنظمة الموزعة:
    -   **Eureka Server**: لاكتشاف الخدمات.
    -   **API Gateway**: لبناء بوابة دخول ذكية وموجهة.
    -   **OpenFeign**: لتبسيط عملية التواصل الداخلي بين الخدمات.
    -   **Resilience4j**: لتطبيق نمط قاطع الدائرة (Circuit Breaker) للحماية من الفشل.
    -   **Spring Cloud LoadBalancer**: لتوزيع الحمل تلقائيًا على نسخ الخدمات.
-   **🗃️ H2 In-Memory Database**: قاعدة بيانات في الذاكرة لتسريع عملية التطوير والاختبار.
-   **🛠️ Apache Maven**: لإدارة اعتماديات المشروع وبنائه.
-   **🧪 Postman**: لاختبار واجهات برمجة التطبيقات (APIs) بشكل شامل.

---

## 5. هيكلية المشروع (Project Structure)

المستودع منظم على شكل مشروع متعدد الوحدات (Multi-module)، حيث تمثل كل خدمة وحدة منفصلة:

e-learning-microservices/
├── 📂 eureka-server/ # خادم اكتشاف الخدمات
├── 📂 api-gateway/ # بوابة الدخول الموحدة
├── 📂 user-service/ # خدمة إدارة المستخدمين
├── 📂 course-service/ # خدمة إدارة الدورات
└── 📜 README.md # هذا الملف

---

## 6. كيفية تشغيل المشروع (Getting Started)

لتشغيل هذا المشروع محليًا، يرجى اتباع الخطوات التالية بالترتيب.

### المتطلبات المسبقة (Prerequisites)

-   **Java Development Kit (JDK) 17** أو أحدث.
-   **Apache Maven 3.8** أو أحدث.
-   **Postman** (أو أي عميل HTTP آخر) لاختبار الـ APIs.

### خطوات التشغيل

1.  **نسخ المستودع (Clone the repository):**
    ```bash
    git clone [رابط المستودع الخاص بك هنا]
    cd e-learning-microservices
    ```

2.  **بناء جميع المشاريع (Build all projects):**
    افتح موجه الأوامر (Terminal/CMD) في المجلد الجذر للمشروع وقم بتشغيل الأمر التالي لبناء جميع الخدمات.
    ```bash
    mvn clean package -DskipTests
    ```

3.  **تشغيل الخدمات (Run the services):**
    يجب تشغيل الخدمات **بالترتيب التالي** لضمان عمل النظام بشكل صحيح. افتح نافذة موجه أوامر جديدة لكل خدمة.

    **أ. تشغيل Eureka Server (دليل الهاتف):**
    ```bash
    java -jar eureka-server/target/eureka-server-0.0.1-SNAPSHOT.jar
    ```
    -   انتظر حتى يعمل بشكل كامل. يمكنك التحقق من لوحة التحكم عبر المتصفح: `http://localhost:8761`

    **ب. تشغيل User Service (خدمة المستخدمين):**
    ```bash
    java -jar user-service/target/user-service-0.0.1-SNAPSHOT.jar
    ```
    -   تحقق من لوحة تحكم Eureka للتأكد من أن `USER-SERVICE` قد سجل نفسه.

    **ج. تشغيل Course Service (خدمة الدورات):**
    ```bash
    java -jar course-service/target/course-service-0.0.1-SNAPSHOT.jar
    ```
    -   تحقق من لوحة تحكم Eureka للتأكد من أن `COURSE-SERVICE` قد سجل نفسه.

    **د. تشغيل API Gateway (البوابة):**
    ```bash
    java -jar api-gateway/target/api-gateway-0.0.1-SNAPSHOT.jar
    ```

**تهانينا!** النظام الآن يعمل بالكامل. جميع الطلبات يجب أن توجه إلى بوابة الدخول على `http://localhost:8080`.

---

## 7. واجهات برمجة التطبيقات (API Endpoints)

فيما يلي قائمة بأهم نقاط النهاية (Endpoints) لاختبار وظائف النظام. **تذكر: جميع الطلبات يجب أن تمر عبر البوابة (`http://localhost:8080`)**.

### 🔹 User Service (`/api/users`)

| Method | Endpoint              | الوصف                   | مثال على جسم الطلب (Request Body)                                        |
| :----- | :-------------------- | :----------------------- | :----------------------------------------------------------------------- |
| `POST` | `/api/users`          | إنشاء مستخدم جديد (مدرب) | `{"name":"Zen Ali", "email":"zen.instructor@example.com", "role":"INSTRUCTOR"}` |
| `GET`  | `/api/users`          | جلب قائمة جميع المستخدمين | `N/A`                                                                    |
| `GET`  | `/api/users/{id}`     | جلب مستخدم محدد بالـ ID  | `N/A`                                                                    |

### 🔹 Course Service (`/api/courses`)

| Method | Endpoint              | الوصف                                | مثال على جسم الطلب (Request Body)                                                         |
| :----- | :-------------------- | :---------------------------------- | :--------------------------------------------------------------------------------------- |
| `POST` | `/api/courses`        | إنشاء دورة جديدة (يتطلب `instructorId` صالح) | `{"title":"Intro to Microservices", "description":"A course on Spring", "price":100, "instructorId":1}` |
| `GET`  | `/api/courses`        | جلب قائمة جميع الدورات المعتمدة (`APPROVED`) | `N/A`                                                                                    |
| `PUT`  | `/api/courses/{id}/approve` | الموافقة على دورة (من قبل المسؤول)           | `N/A`                                                                                    |

---

## 8. المفاهيم المتقدمة التي تم تطبيقها

-   **✅ Service Discovery & Dynamic Routing**: تمكنت `API Gateway` من توجيه الطلبات إلى الخدمات الصحيحة ديناميكيًا باستخدام أسماء الخدمات المسجلة في `Eureka`.
-   **✅ Inter-service Communication**: تم إثبات التواصل الناجح بين `Course-Service` و `User-Service` باستخدام `OpenFeign` للتحقق من بيانات المدرب قبل إنشاء دورة.
-   **✅ Fault Tolerance (Circuit Breaker)**: عند إيقاف `User-Service`، يفشل طلب إنشاء دورة بشكل فوري وسريع مع رسالة خطأ واضحة بفضل `Resilience4j`، بدلاً من تعليق النظام.
-   **✅ Load Balancing**: تم التحقق من قدرة النظام على توزيع الحمل عن طريق تشغيل نسختين من `Course-Service` على منافذ مختلفة. يقوم `Spring Cloud LoadBalancer` تلقائيًا بتوزيع الطلبات بينهما.
    ```bash
    # لتشغيل نسخة ثانية من خدمة الدورات
    java -jar course-service/target/course-service-0.0.1-SNAPSHOT.jar --server.port=9091
    ```

---

## 9. الأعمال المستقبلية (Future Work)

-   **🔒 تطبيق الأمن**: إضافة طبقة أمن باستخدام Spring Security و JWT/OAuth2 على مستوى البوابة.
-   **💳 خدمة الدفع**: إنشاء خدمة مستقلة لإدارة عمليات الدفع والاشتراك.
-   **✍️ خدمة التقييمات**: بناء خدمة لإدارة الاختبارات والواجبات الخاصة بالدورات.
-   **📨 التواصل غير المتزامن**: استخدام RabbitMQ أو Kafka لإرسال الإشعارات (مثل إشعار المدرب عند الموافقة على دورته).
-   **📊 المراقبة والتحليل المركزي**: دمج حزمة ELK (Elasticsearch, Logstash, Kibana) لتجميع وتحليل السجلات من جميع الخدمات في مكان واحد.

---

## 10. الترخيص (License)

هذا المشروع مرخص تحت رخصة MIT. انظر ملف `LICENSE` لمزيد من التفاصيل.

---
## 11.**إعداد:** 
 
-   **سمر احمد علوش**
-   **صفا بسام خليفة**
-   **فاطمة وهيب شاكر**
-   **دعاء رفيق البغدادي**
-   **حمزة سلمان درويش**
